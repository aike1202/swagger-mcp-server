
# Swagger MCP Server

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ MCP (Model Context Protocol) æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿå°†ä»»æ„ Swagger/OpenAPI æ–‡æ¡£è½¬åŒ–ä¸º AI å¯ç†è§£ã€å¯è°ƒç”¨çš„å·¥å…·é›†ã€‚å®ƒä¸ä»…æ”¯æŒæ–‡æ¡£æŸ¥è¯¢ï¼Œè¿˜æ”¯æŒ**æ¥å£è°ƒè¯•**ã€**ä»£ç ç”Ÿæˆ**å’Œ**cURL å‘½ä»¤æ„å»º**ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ” æ™ºèƒ½æ–‡æ¡£æŸ¥è¯¢
*   **`list_services`**: æŸ¥çœ‹æ‰€æœ‰é…ç½®çš„ API æœåŠ¡ã€‚
*   **`list_endpoints`**: åˆ—å‡ºæœåŠ¡ä¸­çš„æ‰€æœ‰æ¥å£æ‘˜è¦ã€‚
*   **`search_apis`**: æ”¯æŒ**æ™ºèƒ½æ¨¡ç³Šæœç´¢**ï¼ˆåŠ æƒåŒ¹é…ï¼‰ã€‚ä¾‹å¦‚æœç´¢ "user create"ï¼Œå³ä½¿æ¥å£æ˜¯ "create new user" ä¹Ÿèƒ½ç²¾å‡†å‘½ä¸­ã€‚
*   **`get_endpoint_details`**: è·å–æ¥å£çš„å®Œæ•´å®šä¹‰ï¼ŒåŒ…æ‹¬è¯·æ±‚å‚æ•°ã€Body ç»“æ„å’Œå“åº” Schemaã€‚

### ğŸš€ æ¥å£è°ƒè¯•ä¸æµ‹è¯•
*   **`debug_endpoint`**: **(æ€æ‰‹çº§åŠŸèƒ½)** è®© AI ç›´æ¥è°ƒç”¨çœŸå®æ¥å£ã€‚
    *   **è‡ªåŠ¨è®¤è¯ (Auto Auth)**: 
        *   æ”¯æŒåœ¨é…ç½®ä¸­é¢„è®¾è´¦å·å¯†ç ï¼ˆå¦‚ `auth=admin:123456`ï¼‰ã€‚
        *   å½“æ¥å£è¿”å› 401 æ—¶ï¼ŒMCP ä¼šæç¤º AI ä½¿ç”¨é¢„è®¾å‡­è¯ç™»å½•ã€‚
        *   AI è°ƒç”¨ç™»å½•æ¥å£åï¼ŒMCP è‡ªåŠ¨æ•è·å¹¶ç¼“å­˜ Tokenï¼Œåç»­è¯·æ±‚è‡ªåŠ¨æ³¨å…¥ã€‚
    *   **æ™ºèƒ½å‚æ•°è¡¥å…¨**: å¦‚æœä½ æ¼æ‰äº†å¿…å¡«å‚æ•°ï¼ŒMCP ä¼šæ ¹æ® Schema ç±»å‹è‡ªåŠ¨å¡«å……åˆç†çš„é»˜è®¤å€¼ï¼Œé˜²æ­¢ 400 é”™è¯¯ã€‚
    *   **ç½‘ç»œè‡ªåŠ¨çº é”™**: è‡ªåŠ¨å¤„ç† `localhost` vs `127.0.0.1` çš„è¿æ¥é—®é¢˜ã€‚

### ğŸ’» å¼€å‘è€…ç”Ÿäº§åŠ›
*   **`generate_curl`**: ç”Ÿæˆæ ‡å‡†çš„ cURL å‘½ä»¤ï¼Œæ–¹ä¾¿åœ¨ç»ˆç«¯å¤ç°è¯·æ±‚ã€‚
*   **Typescript/Client ä»£ç ç”Ÿæˆ**: (V2 æ–°ç‰¹æ€§) ä¸å†ä¾èµ–æ­»æ¿çš„å·¥å…·ï¼Œç›´æ¥è®© AI é˜…è¯» `get_endpoint_details` çš„ Schemaï¼Œç”Ÿæˆç¬¦åˆä½ é¡¹ç›®è§„èŒƒçš„å®Œç¾ä»£ç ã€‚

---

## ğŸ›  å®‰è£…ä¸ä½¿ç”¨

### 1. å®‰è£…ä¾èµ–
```bash
npm install
```

### 2. æ„å»ºé¡¹ç›®
```bash
npm run build
```

### 3. é…ç½® MCP Host (Claude Desktop / Windsurf)

ç¼–è¾‘ä½ çš„ MCP é…ç½®æ–‡ä»¶ï¼ˆå¦‚ `%APPDATA%/Claude/claude_desktop_config.json` æˆ– Windsurf é…ç½®ï¼‰ã€‚

#### æ–¹å¼ä¸€ï¼šNPX å…å®‰è£…æ¨¡å¼ï¼ˆæ¨èï¼‰
ç›´æ¥è¿è¡Œæœ€æ–°å‘å¸ƒçš„åŒ…ï¼Œæ— éœ€æ‰‹åŠ¨ä¸‹è½½æºç ã€‚

```json
{
  "mcpServers": {
    "swagger": {
      "command": "npx",
      "args": [
        "-y",
        "@aike1202/swagger-mcp-server",
        "http://localhost:8090/v3/api-docs"
      ]
    }
  }
}
```

#### æ–¹å¼äºŒï¼šæœ¬åœ°æºç æ¨¡å¼ï¼ˆå¼€å‘ç”¨ï¼‰
å¦‚æœä½  Clone äº†æœ¬é¡¹ç›®å¹¶æƒ³è‡ªå·±ä¿®æ”¹ä»£ç ï¼š

```json
{
  "mcpServers": {
    "swagger": {
      "command": "node",
      "args": [
        "E:/mcp/swagger-mcp/build/index.js", // ä¿®æ”¹ä¸ºä½ çš„å®é™…è·¯å¾„
        "http://localhost:8090/v3/api-docs"
      ]
    }
  }
}
```

#### è¿›é˜¶é…ç½®ï¼ˆå¤šæœåŠ¡ + è‡ªåŠ¨è®¤è¯ï¼‰
æ”¯æŒåŒæ—¶æŒ‚è½½å¤šä¸ªå¾®æœåŠ¡æ–‡æ¡£ï¼Œä»¥åŠè‡ªåŠ¨ç™»å½•é…ç½®ï¼š

```json
{
  "mcpServers": {
    "swagger": {
      "command": "npx", // æˆ– "node"
      "args": [
        "-y",
        "@aike1202/swagger-mcp-server",
        "user=http://localhost:8090/v3/api-docs",
        "order=http://localhost:8091/v3/api-docs",
        "auth=admin:123456"  // [å¯é€‰] é¢„è®¾å‡­è¯ï¼ŒAI é‡åˆ° 401 æ—¶ä¼šçŸ¥é“ç”¨è¿™ä¸ªè´¦å·å»ç™»å½•
      ]
    }
  }
}
```

---

## ğŸ“ å¦‚ä½•é«˜æ•ˆè°ƒç”¨ MCP æœåŠ¡

### 1. è®© AI å­¦ä¹ ä½ çš„é¡¹ç›®è§„åˆ™ (System Prompt / Rules)

ä¸ºäº†è®© AI æ›´å¥½åœ°é…åˆä½ çš„å·¥ä½œæµï¼Œå»ºè®®åœ¨ Cursor/Windsurf çš„ `.cursorrules` æˆ– `.windsurfrules` ä¸­æ·»åŠ ä»¥ä¸‹è§„åˆ™ï¼š

```markdown
# Swagger MCP ä½¿ç”¨è§„èŒƒ

å½“ç”¨æˆ·è¦æ±‚è¿›è¡Œ API å¼€å‘æˆ–è°ƒè¯•æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹ SOPï¼š

1. **æœç´¢å…ˆè¡Œ**: å…ˆä½¿ç”¨ `search_apis` æ‰¾åˆ°ç›¸å…³æ¥å£ï¼Œä¸è¦å‡­ç©ºçŒœæµ‹è·¯å¾„ã€‚
2. **è¯¦æƒ…ç¡®è®¤**: åœ¨å†™ä»£ç æˆ–æµ‹è¯•å‰ï¼Œå¿…é¡»è°ƒç”¨ `get_endpoint_details` ç¡®è®¤å‚æ•°ç»“æ„ã€‚
3. **æ™ºèƒ½æµ‹è¯•**:
    - å¦‚æœéœ€è¦æµ‹è¯•æ¥å£ï¼Œç›´æ¥è°ƒç”¨ `debug_endpoint`ã€‚
    - å¦‚æœé‡åˆ° 401 é”™è¯¯ä¸”æç¤ºæœ‰å­˜å‚¨å‡­è¯ï¼Œè¯·è‡ªåŠ¨å¯»æ‰¾ç™»å½•æ¥å£ï¼ˆå¦‚ `/auth/login`ï¼‰è¿›è¡Œç™»å½•ï¼Œç„¶åå†é‡è¯•åŸè¯·æ±‚ã€‚
    - ä¸éœ€è¦ç”¨æˆ·æä¾›æ‰€æœ‰å‚æ•°ï¼Œåˆ©ç”¨ `debug_endpoint` çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚
4. **ç±»å‹ç”Ÿæˆ**: 
    - ä¸è¦è‡ªå·±çç¼–ç±»å‹ã€‚å…ˆè°ƒç”¨ `get_endpoint_details` è·å– Schemaï¼Œç„¶åæ ¹æ®è¯¥ Schema ä¸ºæˆ‘ç”Ÿæˆ TypeScript æ¥å£ã€‚
    - æ¥å£å‘½åé£æ ¼è¯·éµå¾ª IRequest, IResponseã€‚
```

### 2. å¸¸ç”¨å¯¹è¯æŒ‡ä»¤ (Prompt ç¤ºä¾‹)

*   **å…¨è‡ªåŠ¨æµ‹è¯•æµç¨‹**:
    > "å¸®æˆ‘æµ‹ä¸€ä¸‹åˆ›å»ºè®¢å•æ¥å£ï¼Œå‚æ•°éšä¾¿å¡«ï¼Œåªè¦èƒ½è·‘é€šå°±è¡Œã€‚" 
    > *(AI ä¼šè‡ªåŠ¨æœç´¢æ¥å£ -> æŸ¥è¯¦æƒ… -> è‡ªåŠ¨è¡¥å…¨å‚æ•° -> è°ƒç”¨ -> å¦‚æœ 401 è‡ªåŠ¨ç™»å½• -> é‡è¯•)*

*   **å‰ç«¯è”è°ƒ (æ–°ç©æ³•)**:
    > "æˆ‘è¦å¯¹æ¥æŸ¥è¯¢ç”¨æˆ·æ¥å£ï¼Œå…ˆæŸ¥ä¸€ä¸‹å®ƒçš„å®šä¹‰ï¼Œç„¶åå¸®æˆ‘ç”Ÿæˆ React Hook å’Œ TS ç±»å‹ã€‚"
    > *(AI ä¼šå…ˆæŸ¥æ–‡æ¡£ï¼Œç„¶ååˆ©ç”¨å®ƒçš„ä»£ç ç”Ÿæˆèƒ½åŠ›ç›´æ¥å†™å‡ºå®Œç¾çš„ React ä»£ç ï¼Œæ¯”æ—§ç‰ˆ generate_interface å·¥å…·æ›´å¼º)*

*   **æ’æŸ¥é—®é¢˜**:
    > "è¿™ä¸ªæ¥å£ä¸€ç›´æŠ¥é”™ï¼Œå¸®æˆ‘çœ‹çœ‹å‚æ•°ä¼ å¾—å¯¹ä¸å¯¹ï¼Œé¡ºä¾¿ç”Ÿæˆä¸ª curl æˆ‘åœ¨ç»ˆç«¯é‡Œè¯•è¯•ã€‚"

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ index.ts             # æœåŠ¡å…¥å£
â”œâ”€â”€ services/
â”‚   â””â”€â”€ loader.ts        # æ–‡æ¡£åŠ è½½ã€å¤šæœåŠ¡ç®¡ç†ã€Token ç¼“å­˜ã€å‡­è¯ç®¡ç†
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ index.ts         # MCP å·¥å…·å®šä¹‰ (Search, Debug, Curl...)
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ schema.ts        # JSON Schema è§£æ
â””â”€â”€ types/
    â””â”€â”€ swagger.ts       # ç±»å‹å®šä¹‰
```

## âš¡ å¸¸è§é—®é¢˜ (FAQ)

*   **Q: è¿æ¥ `localhost` æŠ¥é”™ `connect EACCES ::1:8090`?**
    *   A: MCP Server å·²å†…ç½®è‡ªåŠ¨çº é”™æœºåˆ¶ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° `127.0.0.1` é‡è¯•ï¼Œæ— éœ€æ‰‹åŠ¨ä¿®æ”¹ Hostã€‚

*   **Q: ç™»å½•æ¥å£çš„ Token ä¸åœ¨ `data.token` å­—æ®µé‡Œæ€ä¹ˆåŠï¼Ÿ**
    *   A: ç›®å‰æ”¯æŒè‡ªåŠ¨è¯†åˆ« `token`, `accessToken`, `access_token` ä»¥åŠ `Authorization` å¤´ã€‚å¦‚æœä½ çš„ç»“æ„å¾ˆç‰¹æ®Šï¼Œè¯·ä¿®æ”¹ `src/tools/index.ts` ä¸­çš„ heuristic é€»è¾‘ã€‚

---

**Enjoy your AI-powered API development! ğŸš€**
